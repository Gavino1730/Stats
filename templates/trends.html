{% extends "base.html" %}

{% block content %}
<style>
    .trends-volatility-grid {
        margin-bottom: 2.5rem;
    }
    
    .trends-charts-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(550px, 1fr));
        gap: 2.5rem;
        margin-top: 2rem;
    }
    
    /* Single column charts at full width */
    .trends-charts-grid .chart-container.full-width {
        grid-column: 1 / -1;
    }
    
    .insights-section {
        margin: 3rem 0 2rem 0;
        padding: 1.5rem;
        background: var(--light-bg);
        border-radius: 8px;
        border: 1px solid var(--border);
    }
    
    .insights-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
        margin-top: 1rem;
    }
    
    .insight-card {
        background: var(--card-bg);
        padding: 1.5rem;
        border-radius: 6px;
        border-left: 4px solid var(--primary);
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }
    
    .insight-title {
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--primary);
        margin: 0 0 0.75rem 0;
    }
    
    .insight-content {
        color: var(--text);
        line-height: 1.5;
    }
    
    .recommendations-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }
    
    .recommendations-list li {
        padding: 0.75rem;
        margin: 0.5rem 0;
        background: var(--light-bg);
        border-radius: 4px;
        border-left: 3px solid;
    }
    
    .rec-high { border-left-color: #dc2626; }
    .rec-medium { border-left-color: #f59e0b; }
    .rec-low { border-left-color: #10b981; }
    
    .player-insights-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1rem;
        margin-top: 1rem;
    }
    
    .player-insight-card {
        background: var(--card-bg);
        padding: 1rem;
        border-radius: 6px;
        border: 1px solid var(--border);
    }
    
    .player-insight-name {
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--primary);
        margin-bottom: 0.5rem;
    }
    
    .player-insight-role {
        font-size: 0.9rem;
        color: var(--text-light);
        background: var(--light-bg);
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        display: inline-block;
        margin-bottom: 0.75rem;
    }
    
    .strengths, .improvements {
        margin: 0.75rem 0;
    }
    
    .strengths h4, .improvements h4 {
        font-size: 0.85rem;
        text-transform: uppercase;
        color: var(--text-light);
        margin: 0 0 0.5rem 0;
    }
    
    .strength-tags, .improvement-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 0.25rem;
    }
    
    .strength-tag {
        background: #10b981;
        color: white;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        font-size: 0.75rem;
    }
    
    .improvement-tag {
        background: #f59e0b;
        color: white;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        font-size: 0.75rem;
    }
    
    /* Mobile responsive adjustments */
    @media (max-width: 768px) {
        .trends-charts-grid {
            grid-template-columns: 1fr;
            gap: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .insights-section {
            margin: 2rem 0 1.5rem 0;
            padding: 1rem;
        }
        
        .insights-grid {
            grid-template-columns: 1fr;
            gap: 1rem;
        }
        
        .player-insights-grid {
            grid-template-columns: 1fr;
        }
        
        .insight-card {
            padding: 1rem;
        }
        
        .player-selector {
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .player-selector select {
            width: 100%;
        }
    }
    
    @media (max-width: 480px) {
        .trends-volatility-grid {
            margin-bottom: 1.5rem;
        }
        
        .trends-charts-grid {
            gap: 1.25rem;
            margin-top: 1rem;
        }
        
        .insights-section {
            margin: 1.5rem 0 1rem 0;
            padding: 0.75rem;
        }
        
        .insight-card {
            padding: 0.75rem;
        }
        
        .player-insight-card {
            padding: 0.75rem;
        }
    }
    
    .comparison-section {
        margin: 2rem 0;
    }
    
    .player-selector {
        display: flex;
        gap: 1rem;
        margin: 1rem 0;
        align-items: center;
    }
    
    .player-selector select {
        padding: 0.5rem;
        border: 1px solid var(--border);
        border-radius: 4px;
        min-width: 150px;
    }
    
    .comparison-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-top: 1rem;
    }
    
    .comparison-stat {
        background: var(--card-bg);
        padding: 1rem;
        border-radius: 6px;
        border: 1px solid var(--border);
        text-align: center;
    }
    
    .comparison-stat-name {
        font-size: 0.85rem;
        color: var(--text-light);
        text-transform: uppercase;
        margin-bottom: 0.5rem;
    }
    
    .comparison-values {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .comparison-value {
        font-size: 1.2rem;
        font-weight: 700;
    }
    
    .comparison-winner {
        color: var(--primary);
    }
</style>

<div class="trends-page">
    <h1>Trends & Insights</h1>
    
    <div class="trends-tabs">
        <button class="tab-button active" data-tab="team">Team Trends</button>
        <button class="tab-button" data-tab="player">Player Trends</button>
        <button class="tab-button" data-tab="comparison">Player Comparison</button>
    </div>

    <!-- Team Trends Tab -->
    <div id="team-tab" class="tab-content active">
        <!-- Volatility & Patterns -->
        <div class="stats-grid trends-volatility-grid">
            <div class="stat-card">
                <div class="stat-label">PPG Range</div>
                <div class="stat-value" id="ppg-range">--</div>
                <div class="stat-detail">Scoring Variance</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">FG% Std Dev</div>
                <div class="stat-value" id="fg-std">--</div>
                <div class="stat-detail">Shooting Consistency</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">TO Std Dev</div>
                <div class="stat-value" id="to-std">--</div>
                <div class="stat-detail">Turnover Consistency</div>
            </div>
        </div>
        
        <!-- Charts Grid -->
        <div class="trends-charts-grid">
            <div class="chart-container">
                <h2>Scoring by Game</h2>
                <canvas id="teamScoringChart"></canvas>
            </div>
            
            <div class="chart-container">
                <h2>Shooting Efficiency by Game</h2>
                <canvas id="teamShootingChart"></canvas>
            </div>
            
            <div class="chart-container">
                <h2>Rebounding Trends</h2>
                <canvas id="teamReboundingChart"></canvas>
            </div>
            
            <div class="chart-container">
                <h2>Assists vs Turnovers</h2>
                <canvas id="teamAstChart"></canvas>
            </div>
            
            <div class="chart-container">
                <h2>Defensive Activity (Steals & Blocks)</h2>
                <canvas id="teamDefenseChart"></canvas>
            </div>
            
            <div class="chart-container">
                <h2>Free Throw Performance</h2>
                <canvas id="teamFTChart"></canvas>
            </div>
        </div>
    </div>

    <!-- Player Trends Tab -->
    <div id="player-tab" class="tab-content">
        <div class="player-selector">
            <select id="playerSelect" aria-label="Select a player">
                <option value="">Select a player...</option>
            </select>
        </div>
        <div class="chart-container">
            <h2>Points by Game</h2>
            <canvas id="playerPtsChart"></canvas>
        </div>
        <div class="chart-container">
            <h2>Shooting Efficiency</h2>
            <canvas id="playerShootingChart"></canvas>
        </div>
        <div class="chart-container">
            <h2>Rebounds & Assists</h2>
            <canvas id="playerRebAstChart"></canvas>
        </div>
    </div>
    
    <!-- Player Comparison Tab -->
    <div id="comparison-tab" class="tab-content">
        <div class="comparison-section">
            <h2>Compare Players</h2>
            <div class="player-selector">
                <label for="player1Select">Player 1:</label>
                <select id="player1Select">
                    <option value="">Select player 1...</option>
                </select>
                
                <label for="player2Select">Player 2:</label>
                <select id="player2Select">
                    <option value="">Select player 2...</option>
                </select>
                
                <button id="compareButton" class="btn-primary">Compare</button>
            </div>
            
            <div class="comparison-grid" id="comparison-results">
                <!-- Comparison results will be loaded here -->
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='trends.js') }}?v=1.7"></script>
{% endblock %}
