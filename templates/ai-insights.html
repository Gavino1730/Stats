{% extends "base.html" %}

{% block content %}
<div class="ai-insights-page">
    <h1>AI Stats Assistant</h1>
    <p class="subtitle">Chat with AI about your team stats - ask about players, games, trends, and strategy</p>
    
    <!-- Main Chat Interface -->
    <div class="chatbot-container">
        <div class="chat-header">
            <div class="header-content">
                <span class="chat-title">ğŸ€ Stats Chatbot</span>
                <div class="chat-actions">
                    <button type="button" class="btn-clear-chat" onclick="clearChatHistory()" title="Clear conversation">ğŸ—‘ï¸ Clear</button>
                </div>
            </div>
        </div>
        
        <div class="chat-main">
            <!-- Chat Messages Area -->
            <div class="chat-messages-container" id="chat-messages-container">
                <div class="welcome-message">
                    <h3>ğŸ‘‹ Hi! I'm your AI Stats Assistant</h3>
                    <p>I have access to all your team and player statistics. You can ask me:</p>
                    <ul>
                        <li>ğŸ’ª "Who are our top scorers?"</li>
                        <li>ğŸ“ˆ "Show me John's shooting trends"</li>
                        <li>ğŸ¯ "How can we improve our three-point shooting?"</li>
                        <li>ğŸ† "Compare our last 3 games"</li>
                        <li>ğŸ“Š "What's our defensive rebound average?"</li>
                    </ul>
                    <p>Just type your question below!</p>
                </div>
            </div>
            
            <!-- Typing Indicator -->
            <div class="typing-indicator hidden" id="typing-indicator">
                <span></span>
                <span></span>
                <span></span>
            </div>
            
            <!-- Input Area -->
            <div class="chat-input-container">
                <div class="quick-prompts" id="quick-prompts">
                    <button type="button" class="quick-prompt-btn" onclick="sendQuickPrompt('Give me a team summary')">ğŸ“‹ Team Summary</button>
                    <button type="button" class="quick-prompt-btn" onclick="sendQuickPrompt('Who are our top 3 scorers?')">ğŸ€ Top Scorers</button>
                    <button type="button" class="quick-prompt-btn" onclick="sendQuickPrompt('What are our strengths and weaknesses?')">ğŸ’¡ Strengths & Weaknesses</button>
                </div>
                <div class="input-wrapper">
                    <textarea 
                        id="chat-input" 
                        placeholder="Ask about stats, players, games, trends..." 
                        rows="1"
                        onkeydown="handleChatKeydown(event)"
                        oninput="autoResizeInput(this)"></textarea>
                    <button type="button" id="send-btn" onclick="sendMessage()" class="send-btn">
                        <span class="send-icon">â¤</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Stats Context Panel (Sidebar) -->
    <div class="stats-panel hidden" id="stats-panel">
        <div class="stats-panel-header">
            <h3>ğŸ“Š Current Stats Context</h3>
            <button type="button" onclick="toggleStatsPanel()" class="close-panel">âœ•</button>
        </div>
        <div class="stats-panel-content">
            <div class="stats-section">
                <h4>Team Record</h4>
                <div id="team-record-info">Loading...</div>
            </div>
            <div class="stats-section">
                <h4>Top Players</h4>
                <div id="top-players-info">Loading...</div>
            </div>
            <div class="stats-section">
                <h4>Recent Games</h4>
                <div id="recent-games-info">Loading...</div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='ai-insights.js') }}"></script>
{% endblock %}
